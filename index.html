<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Health - T∆∞∆°ng Lai C·ªßa Y T·∫ø</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Marked.js for Markdown parsing in chat -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        medical: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            900: '#1e3a8a',
                        },
                        teal: {
                            400: '#2dd4bf',
                            500: '#14b8a6'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .gradient-text {
            background: linear-gradient(to right, #2563eb, #14b8a6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        /* Chat Widget Animations */
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .chat-animate {
            animation: slideIn 0.3s ease-out forwards;
        }
        /* Hide scrollbar for chat body but keep functionality */
        .no-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .no-scrollbar::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 4px;
        }
        .logo-img {
            object-fit: cover;
        }
        .typing-dot {
            animation: typing 1.4s infinite ease-in-out both;
        }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
        /* Slider Specific Styles */
        .slider-container {
            position: relative;
            overflow: hidden;
            height: 650px; /* TƒÉng chi·ªÅu cao m·ªôt ch√∫t ƒë·ªÉ hi·ªÉn th·ªã t·ªët h∆°n */
        }
        .slides-wrapper {
            display: flex;
            transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1); /* Chuy·ªÉn ƒë·ªông m∆∞·ª£t h∆°n */
            height: 100%;
        }
        .slide {
            min-width: 100%;
            height: 100%;
            position: relative;
        }
        /* N·ªÅn t·ªëi h∆°n cho ch·ªØ d·ªÖ ƒë·ªçc tr√™n m·ªçi ·∫£nh */
        .slide-overlay {
            background: linear-gradient(to right, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.85) 40%, rgba(255,255,255,0.2) 100%);
        }
        @media (max-width: 768px) {
            .slider-container { height: 550px; }
            .slide-overlay {
                background: rgba(255,255,255,0.9);
            }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <!-- Navigation -->
    <nav class="fixed w-full z-50 bg-white/90 backdrop-blur-md shadow-sm transition-all duration-300" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <!-- Logo Section -->
                <div class="flex-shrink-0 flex items-center gap-3">
                    <div class="relative group">
                        <img src="https://lh3.googleusercontent.com/d/1bURystLDhH1GjgNsRCmOoEWWlxXenNgU" 
                             alt="AI Health Logo" 
                             class="h-12 w-auto rounded-lg shadow-md border border-slate-200 logo-img transition-transform transform group-hover:scale-105"
                             onerror="this.onerror=null; this.src='https://cdn-icons-png.flaticon.com/512/3063/3063176.png'">
                    </div>
                    <span class="font-bold text-xl tracking-tight text-medical-900 hidden sm:block">AI Health<span class="text-teal-500">Care</span></span>
                </div>

                <!-- Desktop Menu -->
                <div class="hidden md:flex space-x-8 items-center">
                    <a href="#home" class="text-slate-600 hover:text-medical-600 font-medium transition">Trang ch·ªß</a>
                    <a href="#solutions" class="text-slate-600 hover:text-medical-600 font-medium transition">Gi·∫£i ph√°p</a>
                    <a href="#ai-tools" class="text-slate-600 hover:text-medical-600 font-medium transition flex items-center gap-1"><i class="fas fa-magic text-xs text-amber-500"></i> C√¥ng c·ª• AI</a>
                    <a href="#about" class="text-slate-600 hover:text-medical-600 font-medium transition">Gi·ªõi thi·ªáu</a>
                    <button onclick="toggleChat()" class="bg-medical-600 text-white px-5 py-2 rounded-full hover:bg-medical-700 transition shadow-lg hover:shadow-xl flex items-center gap-2">
                        <i class="fas fa-robot"></i> H·ªèi AI Ngay
                    </button>
                </div>

                <!-- Mobile menu button -->
                <div class="md:hidden flex items-center">
                    <button id="mobile-menu-btn" class="text-slate-600 hover:text-medical-600 focus:outline-none">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu Panel -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-slate-100">
            <div class="px-4 pt-2 pb-4 space-y-1">
                <a href="#home" class="block px-3 py-2 rounded-md text-base font-medium text-slate-700 hover:text-medical-600 hover:bg-medical-50">Trang ch·ªß</a>
                <a href="#ai-tools" class="block px-3 py-2 rounded-md text-base font-medium text-slate-700 hover:text-medical-600 hover:bg-medical-50">C√¥ng c·ª• AI</a>
                <a href="#" onclick="toggleChat()" class="block px-3 py-2 rounded-md text-base font-medium text-medical-600 hover:bg-medical-50">Chat v·ªõi AI</a>
            </div>
        </div>
    </nav>

    <!-- 5 SLIDERS HERO SECTION -->
    <section id="home" class="pt-20 relative bg-white">
        <div class="slider-container group">
            <div class="slides-wrapper" id="slides-wrapper">
                
                <!-- Slide 1: AI Diagnostics (Updated Image: Doctor looking at digital scans) -->
                <div class="slide bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1581056771107-24ca5f033842?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');">
                    <div class="absolute inset-0 slide-overlay"></div>
                    <div class="relative z-10 h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center">
                        <div class="max-w-2xl p-8 rounded-2xl">
                            <span class="inline-block py-1 px-3 rounded-full bg-medical-50 text-medical-600 text-sm font-semibold mb-4 border border-medical-100 animate-fade-in-up">
                                üöÄ C√¥ng ngh·ªá ƒë·ªôt ph√°
                            </span>
                            <h1 class="text-4xl md:text-6xl font-extrabold text-slate-900 tracking-tight mb-4 leading-tight">
                                Ch·∫©n ƒëo√°n <span class="text-medical-600">Ch√≠nh X√°c</span> <br> v·ªõi AI Deep Learning
                            </h1>
                            <p class="text-lg text-slate-700 mb-8 font-medium">
                                Ph√¢n t√≠ch h√†ng tri·ªáu ƒëi·ªÉm d·ªØ li·ªáu h√¨nh ·∫£nh y t·∫ø (X-quang, MRI) trong gi√¢y l√°t, h·ªó tr·ª£ b√°c sƒ© ph√°t hi·ªán b·ªánh s·ªõm h∆°n bao gi·ªù h·∫øt.
                            </p>
                            <div class="flex gap-4">
                                <a href="#ai-tools" class="px-6 py-3 rounded-lg bg-medical-600 text-white font-semibold hover:bg-medical-700 transition shadow-lg">
                                    Th·ª≠ AI Ngay
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide 2: Virtual Assistant (Updated Image: Robot Hand/Tech connection) -->
                <div class="slide bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1531746790731-6c087fecd65a?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');">
                     <div class="absolute inset-0 slide-overlay"></div>
                    <div class="relative z-10 h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center">
                        <div class="max-w-2xl p-8 rounded-2xl">
                             <span class="inline-block py-1 px-3 rounded-full bg-teal-50 text-teal-600 text-sm font-semibold mb-4 border border-teal-100">
                                ü§ñ Tr·ª£ l√Ω ·∫£o 24/7
                            </span>
                            <h1 class="text-4xl md:text-6xl font-extrabold text-slate-900 tracking-tight mb-4 leading-tight">
                                B√°c Sƒ© ƒê·ªìng H√†nh <br> <span class="text-teal-500">M·ªçi L√∫c M·ªçi N∆°i</span>
                            </h1>
                            <p class="text-lg text-slate-700 mb-8 font-medium">
                                Gi·∫£i ƒë√°p th·∫Øc m·∫Øc y t·∫ø, nh·∫Øc nh·ªü u·ªëng thu·ªëc v√† theo d√µi ch·ªâ s·ªë s·ª©c kh·ªèe li√™n t·ª•c th√¥ng qua Chatbot th√¥ng minh.
                            </p>
                            <div class="flex gap-4">
                                <button onclick="toggleChat()" class="px-6 py-3 rounded-lg bg-teal-500 text-white font-semibold hover:bg-teal-600 transition shadow-lg flex items-center gap-2">
                                    <i class="fas fa-robot"></i> Chat ngay
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide 3: Genomics (DNA/Science) -->
                <div class="slide bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1530210124550-912dc1381cb8?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');">
                    <div class="absolute inset-0 slide-overlay"></div>
                    <div class="relative z-10 h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center">
                        <div class="max-w-2xl p-8 rounded-2xl">
                            <span class="inline-block py-1 px-3 rounded-full bg-indigo-50 text-indigo-600 text-sm font-semibold mb-4 border border-indigo-100">
                                üß¨ Y h·ªçc C√° nh√¢n h√≥a
                            </span>
                            <h1 class="text-4xl md:text-6xl font-extrabold text-slate-900 tracking-tight mb-4 leading-tight">
                                Gi·∫£i M√£ <span class="text-indigo-600">Gen Di Truy·ªÅn</span> <br> T·ªëi ∆Øu Ph√°c ƒê·ªì
                            </h1>
                            <p class="text-lg text-slate-700 mb-8 font-medium">
                                Ph√°c ƒë·ªì ƒëi·ªÅu tr·ªã ung th∆∞ v√† c√°c b·ªánh hi·ªÉm ngh√®o ƒë∆∞·ª£c thi·∫øt k·∫ø ri√™ng bi·ªát d·ª±a tr√™n m√£ gen c·ªßa t·ª´ng ng∆∞·ªùi b·ªánh.
                            </p>
                             <div class="flex gap-4">
                                <a href="#solutions" class="px-6 py-3 rounded-lg bg-indigo-600 text-white font-semibold hover:bg-indigo-700 transition shadow-lg">
                                    Xem chi ti·∫øt
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide 4: Robotic Surgery (Modern Surgery Room) -->
                <div class="slide bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1551076805-e1869033e561?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');">
                    <div class="absolute inset-0 slide-overlay"></div>
                    <div class="relative z-10 h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center">
                        <div class="max-w-2xl p-8 rounded-2xl">
                            <span class="inline-block py-1 px-3 rounded-full bg-rose-50 text-rose-600 text-sm font-semibold mb-4 border border-rose-100">
                                ü¶æ Ph·∫´u thu·∫≠t Robot
                            </span>
                            <h1 class="text-4xl md:text-6xl font-extrabold text-slate-900 tracking-tight mb-4 leading-tight">
                                Ch√≠nh X√°c <span class="text-rose-600">Tuy·ªát ƒê·ªëi</span> <br> Trong Ph√≤ng M·ªï
                            </h1>
                            <p class="text-lg text-slate-700 mb-8 font-medium">
                                Robot ph·∫´u thu·∫≠t h·ªó tr·ª£ b√°c sƒ© th·ª±c hi·ªán c√°c ca m·ªï ph·ª©c t·∫°p v·ªõi ƒë·ªô x√¢m l·∫•n t·ªëi thi·ªÉu v√† ƒë·ªô ch√≠nh x√°c ƒë·∫øn t·ª´ng milimet.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Slide 5: Drug Discovery (Lab/Molecules) -->
                <div class="slide bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1532187863486-abf9dbad1b69?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');">
                    <div class="absolute inset-0 slide-overlay"></div>
                    <div class="relative z-10 h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center">
                        <div class="max-w-2xl p-8 rounded-2xl">
                            <span class="inline-block py-1 px-3 rounded-full bg-emerald-50 text-emerald-600 text-sm font-semibold mb-4 border border-emerald-100">
                                üíä Ph√°t minh D∆∞·ª£c ph·∫©m
                            </span>
                            <h1 class="text-4xl md:text-6xl font-extrabold text-slate-900 tracking-tight mb-4 leading-tight">
                                TƒÉng T·ªëc <span class="text-emerald-600">Nghi√™n C·ª©u</span> <br> Thu·ªëc M·ªõi
                            </h1>
                            <p class="text-lg text-slate-700 mb-8 font-medium">
                                R√∫t ng·∫Øn th·ªùi gian t√¨m ra thu·ªëc m·ªõi t·ª´ h√†ng ch·ª•c nƒÉm xu·ªëng c√≤n v√†i th√°ng nh·ªù m√¥ ph·ªèng c·∫•u tr√∫c ph√¢n t·ª≠ si√™u t·ªëc.
                            </p>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Controls -->
            <button id="prev-slide" class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-white/50 hover:bg-white text-slate-800 p-3 rounded-full shadow-lg transition opacity-0 group-hover:opacity-100 focus:outline-none backdrop-blur-sm">
                <i class="fas fa-chevron-left text-xl"></i>
            </button>
            <button id="next-slide" class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-white/50 hover:bg-white text-slate-800 p-3 rounded-full shadow-lg transition opacity-0 group-hover:opacity-100 focus:outline-none backdrop-blur-sm">
                <i class="fas fa-chevron-right text-xl"></i>
            </button>

            <!-- Indicators (5 dots) -->
            <div class="absolute bottom-6 left-1/2 transform -translate-x-1/2 flex gap-3 z-20">
                <button class="indicator w-3 h-3 rounded-full bg-medical-500 transition-all duration-300 ring-2 ring-white scale-125" onclick="goToSlide(0)"></button>
                <button class="indicator w-3 h-3 rounded-full bg-slate-300 hover:bg-medical-300 transition-all duration-300" onclick="goToSlide(1)"></button>
                <button class="indicator w-3 h-3 rounded-full bg-slate-300 hover:bg-medical-300 transition-all duration-300" onclick="goToSlide(2)"></button>
                <button class="indicator w-3 h-3 rounded-full bg-slate-300 hover:bg-medical-300 transition-all duration-300" onclick="goToSlide(3)"></button>
                <button class="indicator w-3 h-3 rounded-full bg-slate-300 hover:bg-medical-300 transition-all duration-300" onclick="goToSlide(4)"></button>
            </div>
        </div>
    </section>

    <!-- Stats Section -->
    <section class="bg-white py-12 border-y border-slate-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
                <div>
                    <div class="text-4xl font-bold text-medical-600 mb-2">99%</div>
                    <div class="text-slate-500 text-sm">ƒê·ªô ch√≠nh x√°c h√¨nh ·∫£nh</div>
                </div>
                <div>
                    <div class="text-4xl font-bold text-teal-500 mb-2">50%</div>
                    <div class="text-slate-500 text-sm">Gi·∫£m th·ªùi gian ch·∫©n ƒëo√°n</div>
                </div>
                <div>
                    <div class="text-4xl font-bold text-medical-600 mb-2">24/7</div>
                    <div class="text-slate-500 text-sm">H·ªó tr·ª£ li√™n t·ª•c</div>
                </div>
                <div>
                    <div class="text-4xl font-bold text-teal-500 mb-2">100+</div>
                    <div class="text-slate-500 text-sm">B·ªánh vi·ªán √°p d·ª•ng</div>
                </div>
            </div>
        </div>
    </section>

    <!-- NEW: AI Tools Section -->
    <section id="ai-tools" class="py-20 bg-gradient-to-b from-slate-50 to-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <span class="text-teal-600 font-bold tracking-wider uppercase text-sm">C√¥ng ngh·ªá Gemini AI</span>
                <h2 class="text-3xl font-bold text-slate-900 mt-2 mb-4">C√¥ng C·ª• H·ªó Tr·ª£ Tr·ª±c Tuy·∫øn</h2>
                <p class="text-slate-600 max-w-2xl mx-auto">S·ª≠ d·ª•ng s·ª©c m·∫°nh c·ªßa m√¥ h√¨nh ng√¥n ng·ªØ l·ªõn ƒë·ªÉ h·ªó tr·ª£ b·∫°n ngay l·∫≠p t·ª©c. <br><em class="text-sm text-red-500">*L∆∞u √Ω: K·∫øt qu·∫£ ch·ªâ mang t√≠nh tham kh·∫£o, vui l√≤ng ƒë·∫øn b√°c sƒ© ƒë·ªÉ ch·∫©n ƒëo√°n ch√≠nh x√°c.</em></p>
            </div>

            <div class="grid lg:grid-cols-2 gap-10">
                <!-- Tool 1: Symptom Checker -->
                <div class="bg-white rounded-2xl shadow-xl border border-slate-100 overflow-hidden flex flex-col h-full relative group hover:border-medical-300 transition-colors">
                    <div class="bg-medical-50 p-6 border-b border-medical-100">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 rounded-full bg-medical-600 flex items-center justify-center text-white shadow-lg">
                                <i class="fas fa-user-md text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-slate-900">Ph√¢n T√≠ch Tri·ªáu Ch·ª©ng</h3>
                                <p class="text-sm text-slate-500">M√¥ t·∫£ t√¨nh tr·∫°ng c·ªßa b·∫°n, AI s·∫Ω ƒë∆∞a ra nh·∫≠n ƒë·ªãnh s∆° b·ªô.</p>
                            </div>
                        </div>
                    </div>
                    <div class="p-6 flex-1 flex flex-col">
                        <textarea id="symptom-input" rows="4" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-medical-500 focus:bg-white outline-none transition resize-none mb-4 text-sm" placeholder="V√≠ d·ª•: T√¥i b·ªã ƒëau ƒë·∫ßu d·ªØ d·ªôi k√®m theo ch√≥ng m·∫∑t v√† bu·ªìn n√¥n t·ª´ t·ªëi qua..."></textarea>
                        
                        <div id="symptom-result" class="hidden mb-4 p-4 bg-medical-50 rounded-xl border border-medical-100 text-sm prose prose-sm max-w-none text-slate-700 max-h-60 overflow-y-auto"></div>
                        
                        <button onclick="analyzeSymptoms()" id="btn-symptom" class="mt-auto w-full py-3 bg-medical-600 hover:bg-medical-700 text-white rounded-xl font-semibold shadow-md transition flex items-center justify-center gap-2">
                            <span>‚ú® Ph√¢n T√≠ch Ngay</span>
                        </button>
                    </div>
                </div>

                <!-- Tool 2: Medical Term Translator -->
                <div class="bg-white rounded-2xl shadow-xl border border-slate-100 overflow-hidden flex flex-col h-full relative group hover:border-teal-300 transition-colors">
                    <div class="bg-teal-50 p-6 border-b border-teal-100">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 rounded-full bg-teal-500 flex items-center justify-center text-white shadow-lg">
                                <i class="fas fa-book-medical text-xl"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-slate-900">Gi·∫£i M√£ Y Khoa</h3>
                                <p class="text-sm text-slate-500">D·ªãch thu·∫≠t ng·ªØ, k·∫øt qu·∫£ x√©t nghi·ªám sang ng√¥n ng·ªØ d·ªÖ hi·ªÉu.</p>
                            </div>
                        </div>
                    </div>
                    <div class="p-6 flex-1 flex flex-col">
                        <textarea id="term-input" rows="4" class="w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-teal-500 focus:bg-white outline-none transition resize-none mb-4 text-sm" placeholder="V√≠ d·ª•: B·ªánh nh√¢n b·ªã vi√™m m≈©i xoang xu·∫•t ti·∫øt, ni√™m m·∫°c xung huy·∫øt..."></textarea>
                        
                        <div id="term-result" class="hidden mb-4 p-4 bg-teal-50 rounded-xl border border-teal-100 text-sm prose prose-sm max-w-none text-slate-700 max-h-60 overflow-y-auto"></div>
                        
                        <button onclick="simplifyMedicalText()" id="btn-term" class="mt-auto w-full py-3 bg-teal-500 hover:bg-teal-600 text-white rounded-xl font-semibold shadow-md transition flex items-center justify-center gap-2">
                            <span>‚ú® Gi·∫£i Th√≠ch ƒê∆°n Gi·∫£n</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Solutions / Cards Section -->
    <section id="solutions" class="py-20 bg-slate-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl font-bold text-slate-900 mb-4">Gi·∫£i Ph√°p ƒê·ªôt Ph√°</h2>
                <p class="text-slate-600 max-w-2xl mx-auto">AI kh√¥ng thay th·∫ø b√°c sƒ©, AI gi√∫p b√°c sƒ© tr·ªü n√™n tuy·ªát v·ªùi h∆°n.</p>
            </div>

            <div class="grid md:grid-cols-3 gap-8">
                <!-- Card 1 -->
                <div class="bg-white rounded-2xl p-8 shadow-lg hover:shadow-xl transition duration-300 border border-slate-100 group">
                    <div class="w-14 h-14 bg-blue-100 rounded-xl flex items-center justify-center mb-6 group-hover:bg-medical-600 transition duration-300">
                        <i class="fas fa-x-ray text-2xl text-medical-600 group-hover:text-white transition"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-3">Ch·∫©n ƒêo√°n H√¨nh ·∫¢nh</h3>
                    <p class="text-slate-600 mb-4">
                        S·ª≠ d·ª•ng Deep Learning ƒë·ªÉ ph√¢n t√≠ch phim X-quang, MRI, CT v·ªõi ƒë·ªô ch√≠nh x√°c cao, ph√°t hi·ªán ung th∆∞ ·ªü giai ƒëo·∫°n s·ªõm nh·∫•t.
                    </p>
                    <a href="#" class="text-medical-600 font-medium hover:text-medical-700 flex items-center gap-1">Xem chi ti·∫øt <i class="fas fa-arrow-right text-xs"></i></a>
                </div>

                <!-- Card 2 -->
                <div class="bg-white rounded-2xl p-8 shadow-lg hover:shadow-xl transition duration-300 border border-slate-100 group">
                    <div class="w-14 h-14 bg-teal-100 rounded-xl flex items-center justify-center mb-6 group-hover:bg-teal-500 transition duration-300">
                        <i class="fas fa-dna text-2xl text-teal-600 group-hover:text-white transition"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-3">Y H·ªçc C√° Nh√¢n H√≥a</h3>
                    <p class="text-slate-600 mb-4">
                        Ph√¢n t√≠ch gen v√† d·ªØ li·ªáu l·ªãch s·ª≠ b·ªánh √°n ƒë·ªÉ ƒë·ªÅ xu·∫•t ph√°c ƒë·ªì ƒëi·ªÅu tr·ªã ri√™ng bi·ªát, t·ªëi ∆∞u hi·ªáu qu·∫£ cho t·ª´ng b·ªánh nh√¢n.
                    </p>
                    <a href="#" class="text-teal-600 font-medium hover:text-teal-700 flex items-center gap-1">Xem chi ti·∫øt <i class="fas fa-arrow-right text-xs"></i></a>
                </div>

                <!-- Card 3 -->
                <div class="bg-white rounded-2xl p-8 shadow-lg hover:shadow-xl transition duration-300 border border-slate-100 group">
                    <div class="w-14 h-14 bg-purple-100 rounded-xl flex items-center justify-center mb-6 group-hover:bg-purple-600 transition duration-300">
                        <i class="fas fa-pills text-2xl text-purple-600 group-hover:text-white transition"></i>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-3">Ph√°t Minh Thu·ªëc M·ªõi</h3>
                    <p class="text-slate-600 mb-4">
                        R√∫t ng·∫Øn th·ªùi gian nghi√™n c·ª©u d∆∞·ª£c ph·∫©m t·ª´ h√†ng ch·ª•c nƒÉm xu·ªëng c√≤n v√†i th√°ng nh·ªù m√¥ ph·ªèng c·∫•u tr√∫c ph√¢n t·ª≠ b·∫±ng AI.
                    </p>
                    <a href="#" class="text-purple-600 font-medium hover:text-purple-700 flex items-center gap-1">Xem chi ti·∫øt <i class="fas fa-arrow-right text-xs"></i></a>
                </div>
            </div>
        </div>
    </section>

    <!-- Feature Section with Image -->
    <section id="about" class="py-20 bg-white overflow-hidden">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="lg:flex items-center gap-16">
                <div class="lg:w-1/2 mb-10 lg:mb-0 relative">
                    <div class="absolute -top-4 -left-4 w-24 h-24 bg-teal-100 rounded-full mix-blend-multiply filter blur-xl opacity-70"></div>
                    <div class="absolute -bottom-4 -right-4 w-24 h-24 bg-medical-100 rounded-full mix-blend-multiply filter blur-xl opacity-70"></div>
                    <img src="https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80" alt="B√°c sƒ© s·ª≠ d·ª•ng AI" class="rounded-2xl shadow-2xl relative z-10 w-full">
                </div>
                <div class="lg:w-1/2">
                    <h2 class="text-3xl font-bold text-slate-900 mb-6">T∆∞∆°ng t√°c th√¥ng minh gi·ªØa B√°c sƒ© v√† M√°y m√≥c</h2>
                    <p class="text-slate-600 mb-6 text-lg leading-relaxed">
                        H·ªá th·ªëng AI c·ªßa ch√∫ng t√¥i ho·∫°t ƒë·ªông nh∆∞ m·ªôt tr·ª£ l√Ω ·∫£o ƒë·∫Øc l·ª±c. N√≥ kh√¥ng bao gi·ªù m·ªát m·ªèi, c√≥ th·ªÉ x·ª≠ l√Ω h√†ng tri·ªáu ƒëi·ªÉm d·ªØ li·ªáu trong v√†i gi√¢y v√† ƒë∆∞a ra c√°c c·∫£nh b√°o quan tr·ªçng m√† m·∫Øt th∆∞·ªùng c√≥ th·ªÉ b·ªè s√≥t.
                    </p>
                    <ul class="space-y-4">
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-teal-500 mt-1 mr-3"></i>
                            <span class="text-slate-700">T·ª± ƒë·ªông h√≥a quy tr√¨nh nh·∫≠p li·ªáu b·ªánh √°n.</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-teal-500 mt-1 mr-3"></i>
                            <span class="text-slate-700">Theo d√µi ch·ªâ s·ªë sinh t·ªìn th·ªùi gian th·ª±c qua IoT.</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-teal-500 mt-1 mr-3"></i>
                            <span class="text-slate-700">Chatbot t∆∞ v·∫•n s·ª©c kh·ªèe s∆° b·ªô 24/7.</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Gemini Chat Widget -->
    <div id="chat-widget" class="fixed bottom-6 right-6 z-50 flex flex-col items-end pointer-events-none">
        <!-- Chat Window -->
        <div id="chat-window" class="pointer-events-auto bg-white w-[350px] sm:w-[400px] h-[500px] rounded-2xl shadow-2xl border border-slate-200 flex flex-col mb-4 hidden transform origin-bottom-right transition-all duration-300 chat-animate">
            <!-- Header -->
            <div class="bg-gradient-to-r from-medical-600 to-teal-500 p-4 rounded-t-2xl flex justify-between items-center text-white">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center">
                        <i class="fas fa-robot text-sm"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-sm">Tr·ª£ l√Ω AI Y T·∫ø</h4>
                        <span class="text-xs text-blue-100 flex items-center gap-1"><span class="w-2 h-2 bg-green-400 rounded-full"></span> Online</span>
                    </div>
                </div>
                <div class="flex gap-2">
                    <button onclick="toggleSettings()" class="text-white/80 hover:text-white p-1 rounded hover:bg-white/10" title="C√†i ƒë·∫∑t API Key">
                        <i class="fas fa-cog"></i>
                    </button>
                    <button onclick="toggleChat()" class="text-white/80 hover:text-white p-1 rounded hover:bg-white/10">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- API Key Settings Panel (Hidden by default) -->
            <div id="api-settings" class="hidden absolute inset-0 bg-white z-10 rounded-2xl p-6 flex flex-col justify-center">
                <h3 class="text-lg font-bold text-slate-800 mb-4">C·∫•u h√¨nh Gemini AI</h3>
                <p class="text-sm text-slate-600 mb-4">Vui l√≤ng nh·∫≠p Google Gemini API Key c·ªßa b·∫°n ƒë·ªÉ k√≠ch ho·∫°t t√≠nh nƒÉng chat v√† c√°c c√¥ng c·ª• AI.</p>
                <input type="password" id="api-key-input" placeholder="Paste API Key here..." class="w-full p-3 border border-slate-300 rounded-lg mb-4 focus:ring-2 focus:ring-medical-500 outline-none">
                <div class="flex gap-2">
                    <button onclick="saveApiKey()" class="flex-1 bg-medical-600 text-white py-2 rounded-lg hover:bg-medical-700 font-medium">L∆∞u</button>
                    <button onclick="toggleSettings()" class="flex-1 bg-slate-200 text-slate-700 py-2 rounded-lg hover:bg-slate-300 font-medium">H·ªßy</button>
                </div>
                <p class="text-xs text-slate-400 mt-4 text-center">Key ƒë∆∞·ª£c l∆∞u c·ª•c b·ªô tr√™n tr√¨nh duy·ªát c·ªßa b·∫°n.</p>
            </div>

            <!-- Messages Area -->
            <div id="chat-messages" class="flex-1 p-4 overflow-y-auto no-scrollbar bg-slate-50 space-y-4">
                <!-- Welcome Message -->
                <div class="flex items-start gap-2.5">
                    <div class="w-8 h-8 rounded-full bg-gradient-to-r from-medical-600 to-teal-500 flex items-center justify-center flex-shrink-0 text-white text-xs">AI</div>
                    <div class="flex flex-col gap-1 w-full max-w-[320px]">
                        <div class="flex items-center space-x-2 rtl:space-x-reverse">
                            <span class="text-sm font-semibold text-gray-900">Health Assistant</span>
                            <span class="text-xs font-normal text-gray-500">Just now</span>
                        </div>
                        <div class="flex flex-col leading-1.5 p-4 border-gray-200 bg-white rounded-e-xl rounded-es-xl shadow-sm">
                            <p class="text-sm font-normal text-gray-900">Xin ch√†o! T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n v·ªÅ c√°c ch·ªß ƒë·ªÅ AI trong y t·∫ø h√¥m nay?</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Input Area -->
            <div class="p-4 bg-white border-t border-slate-100 rounded-b-2xl">
                <form id="chat-form" class="flex gap-2" onsubmit="handleChatSubmit(event)">
                    <input type="text" id="chat-input" placeholder="Nh·∫≠p c√¢u h·ªèi..." class="flex-1 bg-slate-100 border-0 rounded-full px-4 py-2 focus:ring-2 focus:ring-medical-500 focus:bg-white transition text-sm">
                    <button type="submit" class="bg-medical-600 text-white w-10 h-10 rounded-full hover:bg-medical-700 flex items-center justify-center shadow-md transition disabled:opacity-50 disabled:cursor-not-allowed">
                        <i class="fas fa-paper-plane text-sm"></i>
                    </button>
                </form>
            </div>
        </div>

        <!-- Toggle Button -->
        <button onclick="toggleChat()" class="pointer-events-auto bg-gradient-to-r from-medical-600 to-teal-500 text-white w-14 h-14 rounded-full shadow-lg hover:shadow-2xl hover:scale-110 transition-all duration-300 flex items-center justify-center group relative">
            <i class="fas fa-comment-medical text-2xl group-hover:hidden"></i>
            <i class="fas fa-chevron-down text-2xl hidden group-hover:block"></i>
            <!-- Notification Badge -->
            <span class="absolute -top-1 -right-1 flex h-4 w-4">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-4 w-4 bg-red-500"></span>
            </span>
        </button>
    </div>

    <!-- Footer -->
    <footer class="bg-slate-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-4 gap-8 mb-8">
                <div class="col-span-1 md:col-span-1">
                    <div class="flex items-center gap-2 mb-4">
                         <!-- Fix: Update footer logo URL as well -->
                        <img src="https://lh3.googleusercontent.com/d/1bURystLDhH1GjgNsRCmOoEWWlxXenNgU" 
                             class="h-8 rounded w-auto bg-white p-0.5" 
                             alt="Logo Footer"
                             onerror="this.onerror=null; this.src='https://cdn-icons-png.flaticon.com/512/3063/3063176.png'">
                        <span class="font-bold text-lg">AI HealthCare</span>
                    </div>
                    <p class="text-slate-400 text-sm">Ti√™n phong trong vi·ªác ·ª©ng d·ª•ng tr√≠ tu·ªá nh√¢n t·∫°o v√†o chƒÉm s√≥c s·ª©c kh·ªèe c·ªông ƒë·ªìng.</p>
                </div>
                <div>
                    <h5 class="font-bold mb-4 text-slate-200">Li√™n k·∫øt</h5>
                    <ul class="space-y-2 text-sm text-slate-400">
                        <li><a href="#" class="hover:text-white transition">Trang ch·ªß</a></li>
                        <li><a href="#" class="hover:text-white transition">V·ªÅ ch√∫ng t√¥i</a></li>
                        <li><a href="#" class="hover:text-white transition">D·ªãch v·ª•</a></li>
                    </ul>
                </div>
                <div>
                    <h5 class="font-bold mb-4 text-slate-200">Ph√°p l√Ω</h5>
                    <ul class="space-y-2 text-sm text-slate-400">
                        <li><a href="#" class="hover:text-white transition">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a></li>
                        <li><a href="#" class="hover:text-white transition">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
                    </ul>
                </div>
                <div>
                    <h5 class="font-bold mb-4 text-slate-200">ƒêƒÉng k√Ω nh·∫≠n tin</h5>
                    <div class="flex">
                        <input type="email" placeholder="Email c·ªßa b·∫°n" class="bg-slate-800 border-none text-sm text-white px-4 py-2 rounded-l-md w-full focus:ring-1 focus:ring-medical-500">
                        <button class="bg-medical-600 px-4 py-2 rounded-r-md hover:bg-medical-500 transition">G·ª≠i</button>
                    </div>
                </div>
            </div>
            <div class="border-t border-slate-800 pt-8 flex flex-col md:flex-row justify-between items-center">
                <p class="text-slate-500 text-sm">Hu·ª≥nh T·∫•n Ph√°t - PK04415 - phathtpk04415@gmail.com</p>
                <div class="flex space-x-4 mt-4 md:mt-0">
                    <a href="#" class="text-slate-400 hover:text-white"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="text-slate-400 hover:text-white"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="text-slate-400 hover:text-white"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // --- UI Interactions ---

        // Mobile Menu Toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');

        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // Chat Widget Toggle
        const chatWindow = document.getElementById('chat-window');
        
        function toggleChat() {
            chatWindow.classList.toggle('hidden');
            if (!chatWindow.classList.contains('hidden')) {
                // Focus input when opened
                setTimeout(() => document.getElementById('chat-input').focus(), 100);
            }
        }

        // Settings Toggle
        const settingsPanel = document.getElementById('api-settings');
        function toggleSettings() {
            settingsPanel.classList.toggle('hidden');
            // Load key if exists
            const savedKey = localStorage.getItem('gemini_api_key');
            if(savedKey) {
                document.getElementById('api-key-input').value = savedKey;
            }
        }

        // Save API Key
        function saveApiKey() {
            const key = document.getElementById('api-key-input').value.trim();
            if (key) {
                localStorage.setItem('gemini_api_key', key);
                toggleSettings();
                addSystemMessage("API Key ƒë√£ ƒë∆∞·ª£c l∆∞u. B·∫°n c√≥ th·ªÉ b·∫Øt ƒë·∫ßu chat v√† s·ª≠ d·ª•ng c√¥ng c·ª• AI!");
            } else {
                alert("Vui l√≤ng nh·∫≠p API Key h·ª£p l·ªá.");
            }
        }

        // --- Slider Logic ---
        let currentSlide = 0;
        const slidesWrapper = document.getElementById('slides-wrapper');
        const slides = document.querySelectorAll('.slide');
        const indicators = document.querySelectorAll('.indicator');
        const totalSlides = slides.length;
        let slideInterval;

        function updateSlider() {
            // Update wrapper transform
            slidesWrapper.style.transform = `translateX(-${currentSlide * 100}%)`;
            
            // Update indicators
            indicators.forEach((dot, index) => {
                if (index === currentSlide) {
                    dot.classList.remove('bg-slate-300', 'hover:bg-medical-300');
                    dot.classList.add('bg-medical-500', 'ring-2', 'ring-white', 'scale-125');
                } else {
                    dot.classList.add('bg-slate-300', 'hover:bg-medical-300');
                    dot.classList.remove('bg-medical-500', 'ring-2', 'ring-white', 'scale-125');
                }
            });
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % totalSlides;
            updateSlider();
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
            updateSlider();
        }

        function goToSlide(index) {
            currentSlide = index;
            updateSlider();
            resetTimer();
        }

        function resetTimer() {
            clearInterval(slideInterval);
            slideInterval = setInterval(nextSlide, 5000);
        }

        // Event Listeners for Slider
        document.getElementById('next-slide').addEventListener('click', () => {
            nextSlide();
            resetTimer();
        });

        document.getElementById('prev-slide').addEventListener('click', () => {
            prevSlide();
            resetTimer();
        });

        // Initialize Slider
        resetTimer();


        // --- Shared Gemini API Caller ---
        
        async function callGeminiGeneric(prompt, systemContext) {
            const apiKey = localStorage.getItem('gemini_api_key');
            
            if (!apiKey) {
                toggleChat();
                toggleSettings();
                throw new Error("Missing API Key");
            }

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{
                    parts: [{
                        text: `${systemContext}\n\nUser Input: ${prompt}`
                    }]
                }]
            };

            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                const err = new Error("API call failed");
                err.status = response.status;
                throw err;
            }

            const data = await response.json();
            return data.candidates?.[0]?.content?.parts?.[0]?.text || "Kh√¥ng c√≥ ph·∫£n h·ªìi.";
        }

        // --- AI Tools Logic ---

        // Tool 1: Symptom Checker
        async function analyzeSymptoms() {
            const input = document.getElementById('symptom-input').value.trim();
            const resultDiv = document.getElementById('symptom-result');
            const btn = document.getElementById('btn-symptom');

            if (!input) {
                alert("Vui l√≤ng nh·∫≠p tri·ªáu ch·ª©ng c·ªßa b·∫°n.");
                return;
            }

            // Set loading state
            btn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ƒêang ph√¢n t√≠ch...`;
            btn.disabled = true;
            resultDiv.classList.remove('hidden');
            resultDiv.innerHTML = "<em>ƒêang tham v·∫•n √Ω ki·∫øn AI...</em>";

            try {
                const systemPrompt = "B·∫°n l√† m·ªôt tr·ª£ l√Ω s∆° c·∫•p c·ª©u y t·∫ø. H√£y ph√¢n t√≠ch c√°c tri·ªáu ch·ª©ng sau v√† ƒë∆∞a ra: 1. D·ª± ƒëo√°n s∆° b·ªô (k√®m m·ª©c ƒë·ªô nghi√™m tr·ªçng), 2. L·ªùi khuy√™n n√™n l√†m g√¨ ngay l·∫≠p t·ª©c, 3. C·∫£nh b√°o quan tr·ªçng. Lu√¥n k√®m theo c√¢u: 'ƒê√¢y ch·ªâ l√† tham kh·∫£o, h√£y ƒë·∫øn c∆° s·ªü y t·∫ø g·∫ßn nh·∫•t.'. Tr·∫£ l·ªùi ng·∫Øn g·ªçn b·∫±ng ti·∫øng Vi·ªát.";
                const response = await callGeminiGeneric(input, systemPrompt);
                
                // Use marked.js to render markdown result
                resultDiv.innerHTML = marked.parse(response);
            } catch (error) {
                if (error.message === "Missing API Key") {
                    resultDiv.innerHTML = "Vui l√≤ng nh·∫≠p API Key trong c·ª≠a s·ªï Chat (g√≥c ph·∫£i) ƒë·ªÉ s·ª≠ d·ª•ng.";
                } else {
                    resultDiv.innerHTML = "C√≥ l·ªói x·∫£y ra: " + error.message;
                }
            } finally {
                btn.innerHTML = `<span>‚ú® Ph√¢n T√≠ch Ngay</span>`;
                btn.disabled = false;
            }
        }

        // Tool 2: Medical Term Translator
        async function simplifyMedicalText() {
            const input = document.getElementById('term-input').value.trim();
            const resultDiv = document.getElementById('term-result');
            const btn = document.getElementById('btn-term');

            if (!input) {
                alert("Vui l√≤ng nh·∫≠p n·ªôi dung c·∫ßn gi·∫£i th√≠ch.");
                return;
            }

            // Set loading state
            btn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ƒêang d·ªãch...`;
            btn.disabled = true;
            resultDiv.classList.remove('hidden');
            resultDiv.innerHTML = "<em>ƒêang x·ª≠ l√Ω d·ªØ li·ªáu...</em>";

            try {
                const systemPrompt = "B·∫°n l√† m·ªôt phi√™n d·ªãch vi√™n y khoa. Nhi·ªám v·ª• c·ªßa b·∫°n l√† gi·∫£i th√≠ch ƒëo·∫°n vƒÉn b·∫£n y t·∫ø sau ƒë√¢y sang ti·∫øng Vi·ªát b√¨nh d√¢n, d·ªÖ hi·ªÉu cho ng∆∞·ªùi kh√¥ng c√≥ chuy√™n m√¥n y t·∫ø. Gi·ªØ nguy√™n √Ω nghƒ©a nh∆∞ng d√πng t·ª´ ng·ªØ ƒë∆°n gi·∫£n.";
                const response = await callGeminiGeneric(input, systemPrompt);
                
                resultDiv.innerHTML = marked.parse(response);
            } catch (error) {
                if (error.message === "Missing API Key") {
                    resultDiv.innerHTML = "Vui l√≤ng nh·∫≠p API Key trong c·ª≠a s·ªï Chat (g√≥c ph·∫£i) ƒë·ªÉ s·ª≠ d·ª•ng.";
                } else {
                    resultDiv.innerHTML = "C√≥ l·ªói x·∫£y ra: " + error.message;
                }
            } finally {
                btn.innerHTML = `<span>‚ú® Gi·∫£i Th√≠ch ƒê∆°n Gi·∫£n</span>`;
                btn.disabled = false;
            }
        }


        // --- Chat Logic ---

        const chatMessages = document.getElementById('chat-messages');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const submitBtn = chatForm.querySelector('button');

        async function handleChatSubmit(e) {
            e.preventDefault();
            const message = chatInput.value.trim();
            if (!message) return;

            // Add User Message
            addUserMessage(message);
            chatInput.value = '';
            chatInput.disabled = true;
            submitBtn.disabled = true;

            // Show Loading
            const loadingId = addLoadingIndicator();
            scrollToBottom();

            // Call Gemini API
            try {
                const systemPrompt = "B·∫°n l√† m·ªôt tr·ª£ l√Ω AI chuy√™n v·ªÅ Y t·∫ø v√† S·ª©c kh·ªèe. H√£y tr·∫£ l·ªùi ng·∫Øn g·ªçn, chuy√™n nghi·ªáp, ƒë·ªìng c·∫£m v√† s·ª≠ d·ª•ng ti·∫øng Vi·ªát.";
                const response = await callGeminiGeneric(message, systemPrompt);
                removeMessage(loadingId);
                addBotMessage(response);
            } catch (error) {
                removeMessage(loadingId);
                if (error.message === "Missing API Key") {
                     addSystemMessage("Vui l√≤ng nh·∫≠p API Key ƒë·ªÉ chat.");
                } else {
                    addSystemMessage("L·ªói: " + error.message);
                    if (error.status === 401 || error.status === 403) {
                         addSystemMessage("API Key kh√¥ng h·ª£p l·ªá. Vui l√≤ng ki·ªÉm tra l·∫°i.");
                         localStorage.removeItem('gemini_api_key');
                    }
                }
            } finally {
                chatInput.disabled = false;
                submitBtn.disabled = false;
                chatInput.focus();
                scrollToBottom();
            }
        }

        // --- Helper Functions for Chat UI ---

        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addUserMessage(text) {
            const div = document.createElement('div');
            div.className = "flex items-end justify-end gap-2.5";
            div.innerHTML = `
                <div class="flex flex-col gap-1 w-full max-w-[320px] items-end">
                     <div class="flex flex-col leading-1.5 p-4 border-gray-200 bg-medical-600 text-white rounded-s-xl rounded-ee-xl shadow-sm">
                        <p class="text-sm font-normal">${escapeHtml(text)}</p>
                    </div>
                </div>
            `;
            chatMessages.appendChild(div);
        }

        function addBotMessage(markdownText) {
            const div = document.createElement('div');
            div.className = "flex items-start gap-2.5";
            const htmlContent = marked.parse(markdownText);
            
            div.innerHTML = `
                <div class="w-8 h-8 rounded-full bg-gradient-to-r from-medical-600 to-teal-500 flex items-center justify-center flex-shrink-0 text-white text-xs">AI</div>
                <div class="flex flex-col gap-1 w-full max-w-[320px]">
                    <div class="flex flex-col leading-1.5 p-4 border-gray-200 bg-white rounded-e-xl rounded-es-xl shadow-sm prose prose-sm max-w-none">
                        ${htmlContent}
                    </div>
                </div>
            `;
            chatMessages.appendChild(div);
        }

        function addSystemMessage(text) {
            const div = document.createElement('div');
            div.className = "flex justify-center my-2";
            div.innerHTML = `<span class="text-xs text-slate-400 bg-slate-100 px-2 py-1 rounded-full">${text}</span>`;
            chatMessages.appendChild(div);
        }

        function addLoadingIndicator() {
            const id = 'loading-' + Date.now();
            const div = document.createElement('div');
            div.id = id;
            div.className = "flex items-start gap-2.5";
            div.innerHTML = `
                 <div class="w-8 h-8 rounded-full bg-gradient-to-r from-medical-600 to-teal-500 flex items-center justify-center flex-shrink-0 text-white text-xs">AI</div>
                 <div class="bg-white p-4 rounded-e-xl rounded-es-xl shadow-sm flex items-center gap-1 h-10">
                    <div class="w-2 h-2 bg-slate-400 rounded-full typing-dot"></div>
                    <div class="w-2 h-2 bg-slate-400 rounded-full typing-dot"></div>
                    <div class="w-2 h-2 bg-slate-400 rounded-full typing-dot"></div>
                 </div>
            `;
            chatMessages.appendChild(div);
            return id;
        }

        function removeMessage(id) {
            const el = document.getElementById(id);
            if (el) el.remove();
        }

        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, function(m) { return map[m]; });
        }

        if(localStorage.getItem('gemini_api_key')) {
             console.log("Gemini is ready.");
        }
    </script>
</body>
</html>
